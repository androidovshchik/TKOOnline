apply plugin: 'kotlin2js'
apply plugin: 'org.jetbrains.kotlin.frontend'

repositories {
    jcenter()
    mavenCentral()
}

dependencies {
    implementation "org.jetbrains.kotlin:kotlin-stdlib-js:${Versions.kotlin}"
}

// ./gradlew ... -Pprod
def prod = project.hasProperty('prod')

compileKotlin2Js {
    kotlinOptions {
        moduleKind = 'amd'
        sourceMap = !prod
    }
}

kotlinFrontend {
    npm {
        devDependency "terser-webpack-plugin"
    }
    webpackBundle {
        bundleName = "main"
        if (prod) {
            mode = "production"
        }
    }
    define("PRODUCTION", prod)
}